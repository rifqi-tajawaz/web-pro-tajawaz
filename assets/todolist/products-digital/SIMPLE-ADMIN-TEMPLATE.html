<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - Product Management | Tajawaz Solutions</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    :root {
      --primary-color: #5f2ded;
      --secondary-color: #1a1a1a;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
    }

    body {
      background: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .admin-header {
      background: var(--primary-color);
      color: white;
      padding: 1.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .admin-sidebar {
      background: white;
      min-height: calc(100vh - 80px);
      padding: 2rem 0;
      box-shadow: 2px 0 4px rgba(0,0,0,0.05);
    }

    .admin-content {
      padding: 2rem;
    }

    .stat-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      margin-bottom: 1.5rem;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-4px);
    }

    .stat-card .icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      margin-bottom: 1rem;
    }

    .stat-card.primary .icon {
      background: rgba(95, 45, 237, 0.1);
      color: var(--primary-color);
    }

    .stat-card.success .icon {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success-color);
    }

    .stat-card.warning .icon {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning-color);
    }

    .stat-card.danger .icon {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger-color);
    }

    .nav-link {
      color: #6c757d;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      margin: 0.25rem 1rem;
      transition: all 0.3s ease;
    }

    .nav-link:hover,
    .nav-link.active {
      background: rgba(95, 45, 237, 0.1);
      color: var(--primary-color);
    }

    .product-form {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .form-label {
      font-weight: 600;
      color: #374151;
      margin-bottom: 0.5rem;
    }

    .form-control,
    .form-select {
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      padding: 0.75rem;
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(95, 45, 237, 0.1);
    }

    .btn-primary {
      background: var(--primary-color);
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
    }

    .btn-primary:hover {
      background: #4a24b8;
    }

    .product-table {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-sm {
      padding: 0.4rem 0.8rem;
      font-size: 0.875rem;
      border-radius: 6px;
    }

    .badge-custom {
      padding: 0.5rem 1rem;
      border-radius: 50px;
      font-weight: 600;
      font-size: 0.875rem;
    }

    .json-viewer {
      background: #1e293b;
      color: #e2e8f0;
      padding: 1.5rem;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.875rem;
      max-height: 500px;
      overflow-y: auto;
    }

    .quick-actions {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .alert-custom {
      border-radius: 8px;
      border: none;
      padding: 1rem 1.5rem;
    }
  </style>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9RN86C26LP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9RN86C26LP');
</script>

</head>
<body>

  <!-- Admin Header -->
  <header class="admin-header">
    <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h1 class="h4 mb-0">
            <i class="fas fa-shield-alt me-2"></i>
            Product Management Dashboard
          </h1>
          <small class="opacity-75">Tajawaz Solutions</small>
        </div>
        <div>
          <button class="btn btn-light btn-sm me-2">
            <i class="fas fa-bell me-1"></i>
            Notifications
          </button>
          <button class="btn btn-outline-light btn-sm">
            <i class="fas fa-sign-out-alt me-1"></i>
            Logout
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="container-fluid">
    <div class="row">
      
      <!-- Sidebar -->
      <nav class="col-md-2 admin-sidebar">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#dashboard" data-section="dashboard">
              <i class="fas fa-home me-2"></i>
              Dashboard
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#products" data-section="products">
              <i class="fas fa-box me-2"></i>
              Products
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#add-product" data-section="add-product">
              <i class="fas fa-plus-circle me-2"></i>
              Add Product
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#import-export" data-section="import-export">
              <i class="fas fa-exchange-alt me-2"></i>
              Import/Export
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#settings" data-section="settings">
              <i class="fas fa-cog me-2"></i>
              Settings
            </a>
          </li>
        </ul>
      </nav>

      <!-- Main Content -->
      <main class="col-md-10 admin-content">

        <!-- Dashboard Section -->
        <section id="dashboard-section" class="content-section">
          <h2 class="mb-4">Dashboard Overview</h2>
          
          <div class="row">
            <div class="col-md-3">
              <div class="stat-card primary">
                <div class="icon">
                  <i class="fas fa-box"></i>
                </div>
                <h3 class="h2 mb-0" id="total-products">0</h3>
                <p class="text-muted mb-0">Total Products</p>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-card success">
                <div class="icon">
                  <i class="fas fa-check-circle"></i>
                </div>
                <h3 class="h2 mb-0" id="published-products">0</h3>
                <p class="text-muted mb-0">Published</p>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-card warning">
                <div class="icon">
                  <i class="fas fa-clock"></i>
                </div>
                <h3 class="h2 mb-0" id="draft-products">0</h3>
                <p class="text-muted mb-0">Drafts</p>
              </div>
            </div>
            <div class="col-md-3">
              <div class="stat-card danger">
                <div class="icon">
                  <i class="fas fa-star"></i>
                </div>
                <h3 class="h2 mb-0" id="featured-products">0</h3>
                <p class="text-muted mb-0">Featured</p>
              </div>
            </div>
          </div>

          <div class="alert alert-custom alert-info mt-4">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Info:</strong> This is a simple admin panel template. Untuk production, implement proper authentication dan backend API.
          </div>
        </section>

        <!-- Products List Section -->
        <section id="products-section" class="content-section" style="display: none;">
          <h2 class="mb-4">All Products</h2>
          
          <div class="quick-actions">
            <button class="btn btn-primary" onclick="showSection('add-product')">
              <i class="fas fa-plus me-2"></i>
              Add New Product
            </button>
            <button class="btn btn-outline-secondary" onclick="refreshProducts()">
              <i class="fas fa-sync me-2"></i>
              Refresh
            </button>
            <div class="ms-auto">
              <input type="search" class="form-control" placeholder="Search products..." id="search-products">
            </div>
          </div>

          <div class="product-table">
            <table class="table table-hover" id="products-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Product</th>
                  <th>Category</th>
                  <th>Price</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Products will be loaded here -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- Add Product Section -->
        <section id="add-product-section" class="content-section" style="display: none;">
          <h2 class="mb-4">Add New Product</h2>
          
          <div class="product-form">
            <form id="product-form">
              
              <div class="row">
                <div class="col-md-8">
                  <div class="mb-3">
                    <label class="form-label">Product Title *</label>
                    <input type="text" class="form-control" name="title" required placeholder="E.g., Blueprint Bisnis Digital">
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Short Description *</label>
                    <textarea class="form-control" name="short_description" rows="2" required placeholder="Brief description (max 150 chars)"></textarea>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Full Description</label>
                    <textarea class="form-control" name="long_description" rows="5" placeholder="Detailed product description"></textarea>
                  </div>

                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label class="form-label">Category *</label>
                      <select class="form-select" name="category" required>
                        <option value="">Select Category</option>
                        <option value="E-book">E-book</option>
                        <option value="Course">Course</option>
                        <option value="Template">Template</option>
                        <option value="Tools">Tools</option>
                        <option value="Bundle">Bundle</option>
                      </select>
                    </div>

                    <div class="col-md-6 mb-3">
                      <label class="form-label">Sub-category</label>
                      <input type="text" class="form-control" name="subcategory" placeholder="E.g., Business Strategy">
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-4 mb-3">
                      <label class="form-label">Price (IDR) *</label>
                      <input type="number" class="form-control" name="price" required placeholder="297000">
                    </div>

                    <div class="col-md-4 mb-3">
                      <label class="form-label">Original Price</label>
                      <input type="number" class="form-control" name="original_price" placeholder="497000">
                    </div>

                    <div class="col-md-4 mb-3">
                      <label class="form-label">Discount %</label>
                      <input type="number" class="form-control" name="discount" placeholder="40" readonly>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Tags (comma-separated)</label>
                    <input type="text" class="form-control" name="tags" placeholder="bisnis-online, pemula, blueprint">
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="mb-3">
                    <label class="form-label">Product Image</label>
                    <input type="file" class="form-control" name="image" accept="image/*">
                    <small class="text-muted">Recommended: 600x400px, WebP format</small>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Status</label>
                    <select class="form-select" name="status">
                      <option value="published">Published</option>
                      <option value="draft">Draft</option>
                      <option value="archived">Archived</option>
                    </select>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Badge</label>
                    <input type="text" class="form-control" name="badge" placeholder="Best Seller, New, Popular">
                  </div>

                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" name="featured" id="featured">
                    <label class="form-check-label" for="featured">
                      Featured Product
                    </label>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Author</label>
                    <input type="text" class="form-control" name="author" value="Tajawaz Team">
                  </div>
                </div>
              </div>

              <hr class="my-4">

              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save me-2"></i>
                  Save Product
                </button>
                <button type="button" class="btn btn-outline-secondary" onclick="resetForm()">
                  <i class="fas fa-undo me-2"></i>
                  Reset
                </button>
                <button type="button" class="btn btn-outline-danger ms-auto" onclick="showSection('products')">
                  <i class="fas fa-times me-2"></i>
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </section>

        <!-- Import/Export Section -->
        <section id="import-export-section" class="content-section" style="display: none;">
          <h2 class="mb-4">Import / Export Products</h2>
          
          <div class="row">
            <div class="col-md-6">
              <div class="product-form">
                <h5>
                  <i class="fas fa-upload me-2 text-primary"></i>
                  Import Products
                </h5>
                <p class="text-muted">Upload JSON file to import products</p>
                
                <div class="mb-3">
                  <input type="file" class="form-control" id="import-file" accept=".json">
                </div>
                
                <button class="btn btn-primary" onclick="importProducts()">
                  <i class="fas fa-file-import me-2"></i>
                  Import JSON
                </button>
                
                <hr class="my-4">
                
                <div class="alert alert-custom alert-warning">
                  <strong>Warning:</strong> Importing will replace existing product data. Make sure to backup first.
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="product-form">
                <h5>
                  <i class="fas fa-download me-2 text-success"></i>
                  Export Products
                </h5>
                <p class="text-muted">Download products as JSON file</p>
                
                <div class="d-flex gap-2 mb-3">
                  <button class="btn btn-success" onclick="exportProducts()">
                    <i class="fas fa-file-export me-2"></i>
                    Export as JSON
                  </button>
                  
                  <button class="btn btn-outline-success" onclick="exportCSV()">
                    <i class="fas fa-file-csv me-2"></i>
                    Export as CSV
                  </button>
                </div>

                <hr class="my-4">

                <h6>Export Options</h6>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="export-published" checked>
                  <label class="form-check-label" for="export-published">
                    Include Published Products
                  </label>
                </div>
                <div class="form-check mb-2">
                  <input class="form-check-input" type="checkbox" id="export-drafts">
                  <label class="form-check-label" for="export-drafts">
                    Include Drafts
                  </label>
                </div>
              </div>
            </div>
          </div>

          <div class="mt-4">
            <div class="product-form">
              <h5>JSON Preview</h5>
              <div class="json-viewer" id="json-preview">
                // Preview will appear here
              </div>
            </div>
          </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="content-section" style="display: none;">
          <h2 class="mb-4">Settings</h2>
          
          <div class="product-form">
            <h5>General Settings</h5>
            
            <div class="mb-3">
              <label class="form-label">Products per Page</label>
              <input type="number" class="form-control" value="9">
            </div>

            <div class="mb-3">
              <label class="form-label">Default Currency</label>
              <select class="form-select">
                <option value="IDR" selected>IDR - Indonesian Rupiah</option>
                <option value="USD">USD - US Dollar</option>
              </select>
            </div>

            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="auto-backup" checked>
              <label class="form-check-label" for="auto-backup">
                Enable Auto-Backup (every week)
              </label>
            </div>

            <hr class="my-4">

            <h5>Danger Zone</h5>
            <div class="alert alert-custom alert-danger">
              <button class="btn btn-danger btn-sm" onclick="clearAllData()">
                <i class="fas fa-trash me-2"></i>
                Clear All Data
              </button>
              <p class="mb-0 mt-2 small">This action cannot be undone. All product data will be deleted.</p>
            </div>
          </div>
        </section>

      </main>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    /**
     * Simple Admin Panel JavaScript
     * This is a template - implement proper backend integration
     */

    // Sample data (replace with actual data from JSON)
    let productsData = [];

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      loadProducts();
      updateStats();
      setupNavigation();
      setupFormHandlers();
    });

    /**
     * Setup navigation
     */
    function setupNavigation() {
      const navLinks = document.querySelectorAll('.nav-link');
      
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Update active state
          navLinks.forEach(l => l.classList.remove('active'));
          this.classList.add('active');
          
          // Show section
          const section = this.dataset.section;
          showSection(section);
        });
      });
    }

    /**
     * Show specific section
     */
    function showSection(sectionName) {
      const sections = document.querySelectorAll('.content-section');
      sections.forEach(section => {
        section.style.display = 'none';
      });
      
      const targetSection = document.getElementById(sectionName + '-section');
      if (targetSection) {
        targetSection.style.display = 'block';
      }
    }

    /**
     * Load products from localStorage or sample data
     */
    function loadProducts() {
      try {
        const stored = localStorage.getItem('admin_products');
        if (stored) {
          productsData = JSON.parse(stored);
        } else {
          // Load from existing products-data.js
          if (typeof window.productsData !== 'undefined') {
            productsData = window.productsData;
          }
        }
        
        console.log('Products loaded:', productsData.length);
        renderProductsTable();
      } catch (error) {
        console.error('Error loading products:', error);
      }
    }

    /**
     * Save products to localStorage
     */
    function saveProducts() {
      try {
        localStorage.setItem('admin_products', JSON.stringify(productsData));
        console.log('Products saved successfully');
        return true;
      } catch (error) {
        console.error('Error saving products:', error);
        alert('Failed to save products');
        return false;
      }
    }

    /**
     * Update statistics
     */
    function updateStats() {
      const total = productsData.length;
      const published = productsData.filter(p => p.metadata?.status === 'published').length;
      const drafts = productsData.filter(p => p.metadata?.status === 'draft').length;
      const featured = productsData.filter(p => p.metadata?.featured).length;

      document.getElementById('total-products').textContent = total;
      document.getElementById('published-products').textContent = published;
      document.getElementById('draft-products').textContent = drafts;
      document.getElementById('featured-products').textContent = featured;
    }

    /**
     * Render products table
     */
    function renderProductsTable() {
      const tbody = document.querySelector('#products-table tbody');
      if (!tbody) return;

      if (productsData.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="text-center py-4">No products found</td></tr>';
        return;
      }

      tbody.innerHTML = productsData.map(product => `
        <tr>
          <td>${product.id}</td>
          <td>
            <div class="d-flex align-items-center">
              <img src="${product.image || product.media?.thumbnail}" 
                   alt="${product.title}" 
                   width="50" 
                   height="50" 
                   class="rounded me-2"
                   onerror="this.src='./assets/images/dummy-img-600x400.jpg'">
              <div>
                <strong>${product.title}</strong>
                ${product.metadata?.badge ? `<br><span class="badge bg-primary">${product.metadata.badge}</span>` : ''}
              </div>
            </div>
          </td>
          <td>${product.category}</td>
          <td>${product.price || product.pricing?.formattedPrice}</td>
          <td>
            <span class="badge ${getStatusBadgeClass(product.metadata?.status)}">
              ${product.metadata?.status || 'published'}
            </span>
          </td>
          <td>
            <div class="table-actions">
              <button class="btn btn-sm btn-outline-primary" onclick="editProduct(${product.id})">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-sm btn-outline-danger" onclick="deleteProduct(${product.id})">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    /**
     * Get status badge class
     */
    function getStatusBadgeClass(status) {
      switch(status) {
        case 'published': return 'bg-success';
        case 'draft': return 'bg-warning';
        case 'archived': return 'bg-secondary';
        default: return 'bg-info';
      }
    }

    /**
     * Setup form handlers
     */
    function setupFormHandlers() {
      const form = document.getElementById('product-form');
      if (form) {
        form.addEventListener('submit', handleFormSubmit);
        
        // Auto-calculate discount
        const priceInput = form.querySelector('[name="price"]');
        const originalPriceInput = form.querySelector('[name="original_price"]');
        const discountInput = form.querySelector('[name="discount"]');
        
        [priceInput, originalPriceInput].forEach(input => {
          input?.addEventListener('input', function() {
            const price = parseFloat(priceInput.value) || 0;
            const originalPrice = parseFloat(originalPriceInput.value) || 0;
            
            if (price > 0 && originalPrice > 0 && originalPrice > price) {
              const discount = Math.round(((originalPrice - price) / originalPrice) * 100);
              discountInput.value = discount;
            } else {
              discountInput.value = '';
            }
          });
        });
      }
    }

    /**
     * Handle form submission
     */
    function handleFormSubmit(e) {
      e.preventDefault();
      
      const formData = new FormData(e.target);
      const newProduct = {
        id: Date.now(), // Simple ID generation
        title: formData.get('title'),
        category: formData.get('category'),
        description: {
          short: formData.get('short_description'),
          long: formData.get('long_description')
        },
        pricing: {
          price: parseFloat(formData.get('price')),
          originalPrice: parseFloat(formData.get('original_price')) || null,
          formattedPrice: `Rp ${formatNumber(formData.get('price'))}`,
          formattedOriginalPrice: formData.get('original_price') ? `Rp ${formatNumber(formData.get('original_price'))}` : ''
        },
        metadata: {
          tags: formData.get('tags').split(',').map(t => t.trim()),
          status: formData.get('status'),
          badge: formData.get('badge'),
          featured: formData.get('featured') === 'on',
          author: formData.get('author'),
          publishDate: new Date().toISOString()
        },
        image: './assets/images/dummy-img-600x400.jpg', // Placeholder
        link: `./product-detail.html?id=${Date.now()}`
      };

      productsData.push(newProduct);
      
      if (saveProducts()) {
        alert('Product added successfully!');
        e.target.reset();
        updateStats();
        renderProductsTable();
        showSection('products');
      }
    }

    /**
     * Format number as IDR
     */
    function formatNumber(num) {
      return new Intl.NumberFormat('id-ID').format(num);
    }

    /**
     * Reset form
     */
    function resetForm() {
      document.getElementById('product-form').reset();
    }

    /**
     * Edit product
     */
    function editProduct(id) {
      alert('Edit functionality - Coming soon!\nProduct ID: ' + id);
      // Implement edit logic
    }

    /**
     * Delete product
     */
    function deleteProduct(id) {
      if (confirm('Are you sure you want to delete this product?')) {
        productsData = productsData.filter(p => p.id !== id);
        saveProducts();
        updateStats();
        renderProductsTable();
        alert('Product deleted successfully');
      }
    }

    /**
     * Refresh products
     */
    function refreshProducts() {
      loadProducts();
      updateStats();
      alert('Products refreshed!');
    }

    /**
     * Export products as JSON
     */
    function exportProducts() {
      const dataStr = JSON.stringify(productsData, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `products-export-${Date.now()}.json`;
      link.click();
      
      URL.revokeObjectURL(url);
      
      // Show preview
      document.getElementById('json-preview').textContent = dataStr;
    }

    /**
     * Export products as CSV
     */
    function exportCSV() {
      const headers = ['ID', 'Title', 'Category', 'Price', 'Original Price', 'Status', 'Featured'];
      const rows = productsData.map(p => [
        p.id,
        p.title,
        p.category,
        p.pricing?.price || p.price,
        p.pricing?.originalPrice || p.originalPrice || '',
        p.metadata?.status || 'published',
        p.metadata?.featured || p.featured || false
      ]);

      const csvContent = [
        headers.join(','),
        ...rows.map(row => row.join(','))
      ].join('\n');

      const blob = new Blob([csvContent], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `products-export-${Date.now()}.csv`;
      link.click();
      
      URL.revokeObjectURL(url);
    }

    /**
     * Import products
     */
    function importProducts() {
      const fileInput = document.getElementById('import-file');
      const file = fileInput.files[0];
      
      if (!file) {
        alert('Please select a file');
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const imported = JSON.parse(e.target.result);
          
          if (confirm(`Import ${imported.length} products? This will replace existing data.`)) {
            productsData = imported;
            saveProducts();
            updateStats();
            renderProductsTable();
            alert('Products imported successfully!');
          }
        } catch (error) {
          alert('Error parsing JSON file: ' + error.message);
        }
      };
      
      reader.readAsText(file);
    }

    /**
     * Clear all data
     */
    function clearAllData() {
      if (confirm('⚠️ WARNING: This will delete ALL product data. This action cannot be undone!\n\nAre you absolutely sure?')) {
        if (confirm('Last chance! Really delete everything?')) {
          productsData = [];
          saveProducts();
          updateStats();
          renderProductsTable();
          alert('All data cleared');
        }
      }
    }
  </script>

</body>
</html>
